<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1672" height="3333"><desc>title%20Picking%20the%20Lock%20on%20Phicomm's%20Encrypted%20Backdoor%2C%20on%20UDP%20Port%2021210%0A%0Aparticipant%20Client%0Aparticipant%20Server%0A%0Aactivate%20Client%20%23brown%0AClient-%3EServer%3ASend%20the%20token%20%22%3Ccolor%3A%23red%3EABCDEF1234%3C%2Fcolor%3E%22%5Cn%5Cn%5BHEX%3A%20%3Ccolor%3A%23darkgreen%3E41424344454631323334%3C%2Fcolor%3E%5D%0A%0Aactivate%20Server%20%23brown%0A%0AServer-%3EServer%3Acompute%20MD5%20hash%20of%20128-byte%20buffer%5Cnbeginning%20with%20%22%3Ccolor%3A%23red%3EK2_COSTDOWN__VER_3.0%3C%2Fcolor%3E%22%5Cnwith%20the%20rest%20of%20the%20bytes%20left%20null.%5Cn%5CnStore%20the%20result%20as%20%3Ccolor%3A%23blue%3EDEVICE_IDENTIFYING_HASH%3C%2Fcolor%3E%0A%0Aactivate%20Server%20%23orange%0A%0AClient%3C--Server%3AReply%20with%20the%20%3Ccolor%3A%23blue%3EDEVICE_IDENTIFYING_HASH%3C%2Fcolor%3E.%5Cn%5Cn%5BHEX%3A%20%3Ccolor%3A%23darkgreen%3E812B50867EFB281491D8F9285D007914%3C%2Fcolor%3E%5D%0A%0Adeactivate%20Server%0A%0AClient-%3EClient%3AProduce%20a%2032-byte-long%20message%20called%20%3Ccolor%3A%23blue%3EXOR_MASK%3C%2Fcolor%3E%5Cnthat%20the%20Server%20will%20decrypt%20with%20**RSA_public_decrypt()**%2C%5Cnusing%20the%20hardcoded%20public%20key.%5Cn%5CnTwo%20things%20are%20essential%20here%3A%5Cn%5Cn(1)%20the%20fate%20of%20this%20message%20is%20to%20be%20decrypted%20with%20the%5Cn%3Ccolor%3A%23darkblue%3E**HARDCODED%20PUBLIC%20KEY**%3C%2Fcolor%3E%20and%20then%20**XOR**ed%20with%20a%20%5Cnrandomly%20generated%20secret%20text%2031%20ASCII-printable%5Cnbytes.%5Cn%5Cn(2)%20the%20result%20of%20these%20two%20operations%20will%20then%20be%5Cnconcatenated%20with%20the%20salt%20%3Ccolor%3A%23purple%3E**using%20sprintf%20and%20the%20%25s%5Cnformat%20string**%3C%2Fcolor%3E.%5Cn%5CnIf%20we%20can%20discover%20a%20phony%20ciphertext%20that%2C%20when%20decrypted%20with%5Cn**RSA_public_decrypy()**%2C%20with%20the%20%3Ccolor%3A%23darkblue%3E**HARDCODED%20PUBLIC%20KEY**%3C%2Fcolor%3E%5Cnand%20the%20**RSA_NO_PADDING**%20option%2C%20yields%20a%20bytestring%20that%5Cnbegins%20with%20a%20byte%20between%20%3Ccolor%3A%23darkgreen%3E0x21%3C%2Fcolor%3E%20and%20%3Ccolor%3A%23darkgreen%3E0x7f%3C%2Fcolor%3E%2C%20then%20we%20will%20have%20a%5Cn1%20in%2092%20chance%20of%20tricking%20the%20Server%20into%20generating%20a%20%3Ccolor%3A%23blue%3EMASKED_SECRET%3C%2Fcolor%3E%5Cnthat%20begins%20with%20a%20**NULL%20BYTE**.%20This%20will%20cause%20%3Ccolor%3A%23blue%3ETEMP_KEY%3C%2Fcolor%3E%20and%20%3Ccolor%3A%23blue%3EPERM_KEY%3C%2Fcolor%3E%5Cnto%20be%20nothing%20but%20hashes%20of%20their%20respective%20salts.%5Cn%5CnStore%20the%20result%20of%20this%20search%20as%20%3Ccolor%3A%23blue%3EENCRYPTED_XOR_MASK%3C%2Fcolor%3E.%0A%0A%0A%0Aactivate%20Client%20%23salmon%0A%0AClient--%3EServer%3ASend%20%3Ccolor%3A%23blue%3EENCRYPTED_XOR_MASK%3C%2Fcolor%3E%20to%20Server%0A%0AServer-%3EServer%3ADecrypt%20%3Ccolor%3A%23blue%3EENCRYPTED_XOR_MASK%3C%2Fcolor%3E%20with%20**RSA_public_decrypt()**%5Cnand%20store%20result%20as%20%3Ccolor%3A%23blue%3EDECRYPTED_XOR_MASK%3C%2Fcolor%3E%0A%0Aactivate%20Server%20%23salmon%0A%0AServer-%3EServer%3AGenerate%20a%20string%20of%2031%20random%2C%20printable%5Cncharacters%20(between%20ASCII%20codes%20%3Ccolor%3A%23darkgreen%3E0x21%3C%2Fcolor%3E%20and%20%3Ccolor%3A%23darkgreen%3E0x7e%3C%2Fcolor%3E)%5Cnand%20store%20the%20result%20as%20%3Ccolor%3A%23blue%3ESECRET_PLAINTEXT%3C%2Fcolor%3E%0A%0Aactivate%20Server%20%23orange%0A%0AServer-%3EServer%3AEncrypt%20%3Ccolor%3A%23blue%3ESECRET_PLAINTEXT%3C%2Fcolor%3E%20with%20**RSA_public_encrypt()**%5Cnusing%20the%20hardcoded%2C%201024-bit%20public%20RSA%20key%2C%20with%20the%5Cn**RSA_NO_PADDING**%20option%20set%20(%22Textbook%20RSA%22).%5Cn%5CnStore%20the%20128-byte%20result%20as%20%3Ccolor%3A%23blue%3ECHALLENGE_CIPHERTEXT%3C%2Fcolor%3E%0A%0Aactivate%20Server%20%23pink%0A%0A%0AClient%3C--Server%3ASend%20128-byte%20%3Ccolor%3A%23blue%3ECHALLENGE_CIPHERTEXT%3C%2Fcolor%3E%20to%20Client%0A%0A%0Aactivate%20Client%20%23orange%0A%0A%0AServer-%3EServer%3A**XOR**%20%3Ccolor%3A%23blue%3ESECRET_PLAINTEXT%3C%2Fcolor%3E%20with%20the%20first%2031%20bytes%5Cnof%20%3Ccolor%3A%23blue%3EDECRYPTED_XOR_MASK%3C%2Fcolor%3E%2C%20and%20store%20the%20result%20in%5Cn%3Ccolor%3A%23blue%3EMASKED_SECRET%3C%2Fcolor%3E.%0A%0A%0A%0AClient--%3EClient%3AWe%20no%20longer%20need%20to%20be%20able%20to%20decrypt%20the%5Cn%3Ccolor%3A%23blue%3ECHALLENGE_CIPHERTEXT%3C%2Fcolor%3E%2C%20and%20so%20we%20no%20longer%5Cnhave%20any%20need%20of%20the%20%3Ccolor%3A%23darkblue%3E**PRIVATE%20KEY**%3C%2Fcolor%3E.%5Cn%5CnWe%20can%20simply%20set%20%3Ccolor%3A%23blue%3ESECRET_PLAINTEXT%3C%2Fcolor%3E%20to%20the%5Cn**empty%20string**.%0A%0A%0Aactivate%20Client%20%23pink%0A%0A%0A%0A%0A%0A%0A%0AServer-%3EServer%3ACreate%20two%20new%20strings%20by%20calling%5Cn**sprintf(**%3Ccolor%3A%23blue%3ERAW_TEMP_KEY%3C%2Fcolor%3E%2C%20%22%3Ccolor%3A%23purple%3E**%25s**%3C%2Fcolor%3E%3Ccolor%3A%23red%3E%2BTEMP%3C%2Fcolor%3E%22%2C%20%3Ccolor%3A%23blue%3EMASKED_SECRET%3C%2Fcolor%3E**)**%2C%20and%5Cn**sprintf(**%3Ccolor%3A%23blue%3ERAW_PERM_KEY%3C%2Fcolor%3E%2C%20%22%3Ccolor%3A%23purple%3E**%25s**%3C%2Fcolor%3E%3Ccolor%3A%23red%3E%2BPERM%3C%2Fcolor%3E%22%2C%20%3Ccolor%3A%23blue%3EMASKED_SECRET%3C%2Fcolor%3E**)**%2C%5Cnrespectively.%20%5Cn%5Cn%3Ccolor%3A%23red%3E**Note%20that%20if%20%3C%2Fcolor%3E%3Ccolor%3A%23blue%3E**MASKED_SECRET**%3C%2Fcolor%3E%3Ccolor%3A%23red%3E%20begins%20with%20a%20null%20byte%2C%5Cnthen%20the%20strings%20%3C%2Fcolor%3E%3Ccolor%3A%23blue%3E**RAW_TEMP_KEY**%3C%2Fcolor%3E%3Ccolor%3A%23red%3E%20and%20%20%3C%2Fcolor%3E%3Ccolor%3A%23blue%3E**RAW_PERM_KEY**%3C%2Fcolor%3E%3Ccolor%3A%23red%3E%20will%5Cnjust%20be%20%3C%2Fcolor%3E%3Ccolor%3A%23darkred%3E%22%2BTEMP%22%3C%2Fcolor%3E%20%3Ccolor%3A%23red%3Eand%3C%2Fcolor%3E%20%3Ccolor%3A%23darkred%3E%22%2BPERM%22%3C%2Fcolor%3E%3Ccolor%3A%23red%3E%2C%20respectively!%0A%0Aactivate%20Server%20%23yellow%0A%0AServer-%3EServer%3ACompute%20the%20**MD5**%20hashes%20of%20%3Ccolor%3A%23blue%3ERAW_TEMP_KEY%3C%2Fcolor%3E%20and%20%3Ccolor%3A%23blue%3ERAW_PERM_KEY%3C%2Fcolor%3E%5Cnand%20store%20the%2016-byte%20results%20as%20%3Ccolor%3A%23blue%3ETEMP_KEY%3C%2Fcolor%3E%20and%20%3Ccolor%3A%23blue%3EPERM_KEY%3C%2Fcolor%3E%2C%5Cnrespectively.%0A%0AClient--%3EClient%3A%20The%20Client%20is%20now%20expected%20to%20append%20one%20of%20two%5Cnsuffixes%20to%20%3Ccolor%3A%23blue%3ESECRET_PLAINTEXT%3C%2Fcolor%3E%3A%5Cn%5Cn-%20%22%3Ccolor%3A%23red%3E%2BTEMP%3C%2Fcolor%3E%22%2C%20to%20launch%20a%20**telnetd**%20session%20that%20will%5Cn%20%20%20last%20until%20the%20router%20is%20rebooted%2C%20%2F%2For%2F%2F%5Cn-%20%20%22%3Ccolor%3A%23red%3E%2BPERM%3C%2Fcolor%3E%22%2C%20to%20write%20a%20flag%20to%20a%20physical%20volume%2C%5Cn%20%20%20which%20the%20**telnetd_startup**%20daemon%20will%20check%20for%5Cn%20%20%20when%20the%20system%20is%20rebooted%2C%20and%20launch%20**telnetd**%5Cn%20%20%20if%20it%20finds%20it.%5Cn%5Cn%3Ccolor%3A%23red%3E**Remember%20that%20we%20have%20effectively%20set%20%3C%2Fcolor%3E%3Ccolor%3A%23blue%3E**xor(XOR_MASK,SECRET_PLAINTEXT)**%3C%2Fcolor%3E%3Ccolor%3A%23red%3E%20to%5Cnthe%20empty%20string%2C%20so%20the%20suffix%20is%20all%20we%20need%20to%5Cnknow.%3C%2Fcolor%3E**%5Cn%5CnStore%20the%20result%20in%20%3Ccolor%3A%23blue%3ERAW_KEY%3C%2Fcolor%3E.%0A%0Aactivate%20Client%20%23yellow%0A%0AClient--%3EClient%3A%20Compute%20the%20**MD5**%20hash%20of%20%3Ccolor%3A%23blue%3ERAW_KEY%3C%2Fcolor%3E%2C%20and%20store%5Cnthe%20result%20in%20%3Ccolor%3A%23blue%3EBACKDOOR_KEY%3C%2Fcolor%3E.%5Cn%5Cn%3Ccolor%3A%23red%3E**Here%2C%20all%20we%20need%20to%20do%20is%20compute%20the%20MD5%5Cnhash%20of%20%3Ccolor%3A%23darkred%3E%2BTEMP%3C%2Fcolor%3E%3Ccolor%3A%23red%3E%20or%20%3Ccolor%3A%23darkred%3E%2BPERM%3C%2Fcolor%3E%0A%0Aactivate%20Client%20%23red%0A%0AClient--%3EServer%3A%20Send%20%3Ccolor%3A%23blue%3EBACKDOOR_KEY%3C%2Fcolor%3E%20to%20Server%0A%0Aactivate%20Server%20%23red%0A%0AServer--%3EServer%3A%20**If**%20%3Ccolor%3A%23blue%3EBACKDOOR_KEY%3C%2Fcolor%3E%20matches%20%3Ccolor%3A%23blue%3ETEMP_KEY%3C%2Fcolor%3E%20then%5Cncall%20**system(%22%3Ccolor%3A%23red%3Etelnetd%20-l%20%2Fbin%2Flogin.sh%3C%2Fcolor%3E%22)**%2C%5Cnlaunching%20an%20unencrypted%20**telnetd**%20shell%5Cnas%20**root**.%20No%20credentials%20are%20required%20to%5Cnlog%20into%20this%20shell.%5Cn%5Cn**If**%20%3Ccolor%3A%23blue%3EBACKDOOR_KEY%3C%2Fcolor%3E%20matches%20%3Ccolor%3A%23blue%3EPERM_KEY%3C%2Fcolor%3E%20then%5Cncall%20**system(%22%3Ccolor%3A%23red%3Eiwpriv%20ra0%20e2p%2026%3D7010%3C%2Fcolor%3E%22)**%2C%5Cnwriting%20the%20bytes%20%5BHEX%3A%20%3Ccolor%3A%23darkgreen%3E7010%3C%2Fcolor%3E%5D%20to%20**EEPROM**%2C%5Cnat%20offset%20%3Ccolor%3A%23darkgreen%3E0x26%3C%2Fcolor%3E%20(virtual%20address%20%3Ccolor%3A%23darkgreen%3E0x40026%3C%2Fcolor%3E).%20This%5Cncode%20will%20instruct%20the%20**telnetd_startup**%20daemon%5Cnto%20launch%20**telnetd%20-l%20%2Fbin%2Flogin.sh**%20on%20boot.%0A</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="1672" height="3333"/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="22.5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="297.366151838796" y="32.04212955" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Picking the Lock on Phicomm's Encrypted Backdoor, on UDP Port 21210</text></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 62.80785098743945 125.39153363899999 L 62.80785098743945 3333.8767725790003" stroke-miterlimit="10" stroke-width="1.7801183083333332" stroke-dasharray="16.431861307692305,7.120473233333333"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 905.7354112766808 125.39153363899999 L 905.7354112766808 3333.8767725790003" stroke-miterlimit="10" stroke-width="1.7801183083333332" stroke-dasharray="16.431861307692305,7.120473233333333"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 10.68070985 67.715700449 L 114.9349921248789 67.715700449 L 114.9349921248789 125.39153363899999 L 10.68070985 125.39153363899999 L 10.68070985 67.715700449 Z" stroke-miterlimit="10" stroke-width="3.417827152" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="33.8578502245" y="104.03011393899999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Client</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 849.7749380774737 67.715700449 L 961.6958844758879 67.715700449 L 961.6958844758879 125.39153363899999 L 849.7749380774737 125.39153363899999 L 849.7749380774737 67.715700449 Z" stroke-miterlimit="10" stroke-width="3.417827152" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="872.9520784519738" y="104.03011393899999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Server</text></g></g><g><path fill="brown" stroke="black" paint-order="fill stroke markers" d=" M 52.12714113743945 136.072243489 L 73.48856083743945 136.072243489 L 73.48856083743945 3312.515352879 L 52.12714113743945 3312.515352879 L 52.12714113743945 136.072243489" stroke-miterlimit="10" stroke-width="1.7801183083333332" stroke-dasharray=""/><path fill="brown" stroke="black" paint-order="fill stroke markers" d=" M 895.0547014266808 238.607058049 L 916.4161211266808 238.607058049 L 916.4161211266808 3312.515352879 L 895.0547014266808 3312.515352879 L 895.0547014266808 238.607058049" stroke-miterlimit="10" stroke-width="1.7801183083333332" stroke-dasharray=""/><path fill="orange" stroke="black" paint-order="fill stroke markers" d=" M 905.7354112766808 411.634557619 L 927.0968309766807 411.634557619 L 927.0968309766807 514.169372179 L 905.7354112766808 514.169372179 L 905.7354112766808 411.634557619" stroke-miterlimit="10" stroke-width="1.7801183083333332" stroke-dasharray=""/><path fill="salmon" stroke="black" paint-order="fill stroke markers" d=" M 62.80785098743945 1093.063846049 L 84.16927068743945 1093.063846049 L 84.16927068743945 3312.515352879 L 62.80785098743945 3312.515352879 L 62.80785098743945 1093.063846049" stroke-miterlimit="10" stroke-width="1.7801183083333332" stroke-dasharray=""/><path fill="salmon" stroke="black" paint-order="fill stroke markers" d=" M 905.7354112766808 1261.819061679 L 927.0968309766807 1261.819061679 L 927.0968309766807 3312.515352879 L 905.7354112766808 3312.515352879 L 905.7354112766808 1261.819061679" stroke-miterlimit="10" stroke-width="1.7801183083333332" stroke-dasharray=""/><path fill="orange" stroke="black" paint-order="fill stroke markers" d=" M 916.4161211266809 1392.123721849 L 937.7775408266808 1392.123721849 L 937.7775408266808 3312.515352879 L 916.4161211266809 3312.515352879 L 916.4161211266809 1392.123721849" stroke-miterlimit="10" stroke-width="1.7801183083333332" stroke-dasharray=""/><path fill="pink" stroke="black" paint-order="fill stroke markers" d=" M 927.0968309766808 1565.151221419 L 948.4582506766808 1565.151221419 L 948.4582506766808 3312.515352879 L 927.0968309766808 3312.515352879 L 927.0968309766808 1565.151221419" stroke-miterlimit="10" stroke-width="1.7801183083333332" stroke-dasharray=""/><path fill="orange" stroke="black" paint-order="fill stroke markers" d=" M 73.48856083743945 1624.963196579 L 94.84998053743945 1624.963196579 L 94.84998053743945 3312.515352879 L 73.48856083743945 3312.515352879 L 73.48856083743945 1624.963196579" stroke-miterlimit="10" stroke-width="1.7801183083333332" stroke-dasharray=""/><path fill="pink" stroke="black" paint-order="fill stroke markers" d=" M 84.16927068743945 1949.656776019 L 105.53069038743945 1949.656776019 L 105.53069038743945 3312.515352879 L 84.16927068743945 3312.515352879 L 84.16927068743945 1949.656776019" stroke-miterlimit="10" stroke-width="1.7801183083333332" stroke-dasharray=""/><path fill="yellow" stroke="black" paint-order="fill stroke markers" d=" M 937.7775408266808 2186.7685346890003 L 959.1389605266808 2186.7685346890003 L 959.1389605266808 3312.515352879 L 937.7775408266808 3312.515352879 L 937.7775408266808 2186.7685346890003" stroke-miterlimit="10" stroke-width="1.7801183083333332" stroke-dasharray=""/><path fill="yellow" stroke="black" paint-order="fill stroke markers" d=" M 94.84998053743945 2703.714891429 L 116.21140023743945 2703.714891429 L 116.21140023743945 3312.515352879 L 94.84998053743945 3312.515352879 L 94.84998053743945 2703.714891429" stroke-miterlimit="10" stroke-width="1.7801183083333332" stroke-dasharray=""/><path fill="red" stroke="black" paint-order="fill stroke markers" d=" M 105.53069038743945 2876.7423909990002 L 126.89211008743945 2876.7423909990002 L 126.89211008743945 3312.515352879 L 105.53069038743945 3312.515352879 L 105.53069038743945 2876.7423909990002" stroke-miterlimit="10" stroke-width="1.7801183083333332" stroke-dasharray=""/><path fill="red" stroke="black" paint-order="fill stroke markers" d=" M 948.4582506766808 2936.5543661590004 L 969.8196703766807 2936.5543661590004 L 969.8196703766807 3312.515352879 L 948.4582506766808 3312.515352879 L 948.4582506766808 2936.5543661590004" stroke-miterlimit="10" stroke-width="1.7801183083333332" stroke-dasharray=""/><g><g><rect fill="white" stroke="none" x="318.8757539581576" y="168.114373039" width="314.4250913686792" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="318.8757539581576" y="189.47579273899998" width="6.408425909999999" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="318.8757539581576" y="210.83721243899998" width="330.7917543478052" height="27.769845609999997"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="322.0799669131576" y="187.33965076899997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Send the token "</text><text fill="red" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="489.47996080964197" y="187.33965076899997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">ABCDEF1234</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="620.8966325625717" y="187.33965076899997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">"</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="322.0799669131576" y="208.70107046899997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"></text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="322.0799669131576" y="230.06249016899997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[HEX: </text><text fill="darkgreen" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="384.3299669131576" y="230.06249016899997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">41424344454631323334</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="638.6632951602279" y="230.06249016899997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">]</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 73.48856083743945 238.607058049 L 877.4671325403475 238.607058049" stroke-miterlimit="10" stroke-width="1.7801183083333332" stroke-dasharray=""/><g transform="translate(895.0547014266808,238.607058049) translate(-895.0547014266808,-238.607058049)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 877.2535183433475 229.70646650733332 L 895.0547014266808 238.607058049 L 877.2535183433475 247.50764959066666 Z"/></g></g><g><g><rect fill="white" stroke="none" x="952.3745109550141" y="270.649187599" width="388.8084198064844" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="952.3745109550141" y="292.010607299" width="437.85842571926514" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="952.3745109550141" y="313.372026999" width="346.8751007146875" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="952.3745109550141" y="334.733446699" width="6.408425909999999" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="952.3745109550141" y="356.094866399" width="474.5250946111719" height="27.769845609999997"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="955.5787239100141" y="289.87446532900003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">compute MD5 hash of 128-byte buffer</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="955.5787239100141" y="311.23588502900003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">beginning with "</text><text fill="red" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1119.4620552088422" y="311.23588502900003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">K2_COSTDOWN__VER_3.0</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1377.828723910014" y="311.23588502900003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">"</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="955.5787239100141" y="332.59730472900003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">with the rest of the bytes left null.</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="955.5787239100141" y="353.95872442900003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"></text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="955.5787239100141" y="375.320144129" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Store the result as </text><text fill="blue" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1145.9287300135297" y="375.320144129" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">DEVICE_IDENTIFYING_HASH</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 916.4161211266808 383.864712009 L 1012.5425097766808 383.864712009 L 1012.5425097766808 411.634557619 L 944.6843998630142 411.634557619" stroke-miterlimit="10" stroke-width="1.7801183083333332" stroke-dasharray=""/><g transform="translate(927.0968309766808,411.634557619) translate(-927.0968309766808,-411.634557619)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 944.8980140600141 402.7339660773334 L 927.0968309766808 411.634557619 L 944.8980140600141 420.53514916066666 Z"/></g></g><g><g><rect fill="white" stroke="none" x="245.49111040903642" y="443.676687169" width="440.225085360531" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="245.49111040903642" y="465.038106869" width="6.408425909999999" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="245.49111040903642" y="486.399526569" width="488.24175129604737" height="27.769845609999997"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="248.69532336403643" y="462.901964899" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Reply with the </text><text fill="blue" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="398.3953203122786" y="462.901964899" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">DEVICE_IDENTIFYING_HASH</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="676.1619829099349" y="462.901964899" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">.</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="248.69532336403643" y="484.263384599" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"></text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="248.69532336403643" y="505.624804299" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[HEX: </text><text fill="darkgreen" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="310.9453233640364" y="505.624804299" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">812B50867EFB281491D8F9285D007914</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="722.7286485593489" y="505.624804299" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">]</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 905.7354112766808 514.169372179 L 91.0761297237728 514.169372179" stroke-miterlimit="10" stroke-width="1.7801183083333332" stroke-dasharray="8.544567879999999"/><g transform="translate(73.48856083743945,514.169372179) translate(-73.48856083743945,-514.169372179)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 91.28974392077279 505.26878063733335 L 73.48856083743945 514.169372179 L 91.28974392077279 523.0699637206667 Z"/></g></g><g><g><rect fill="white" stroke="none" x="109.44695066577279" y="546.211501729" width="516.5750976629297" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="109.44695066577279" y="567.572921429" width="580.408419711117" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="109.44695066577279" y="588.9343411289999" width="323.79175720882813" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="109.44695066577279" y="610.2957608289998" width="6.408425909999999" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="109.44695066577279" y="631.6571805289998" width="304.6251007146875" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="109.44695066577279" y="653.0186002289997" width="6.408425909999999" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="109.44695066577279" y="674.3800199289997" width="560.3917633123438" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="109.44695066577279" y="695.7414396289996" width="535.7917572088281" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="109.44695066577279" y="717.1028593289996" width="512.1417633123438" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="109.44695066577279" y="738.4642790289995" width="67.85842667293946" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="109.44695066577279" y="759.8256987289994" width="6.408425909999999" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="109.44695066577279" y="781.1871184289994" width="502.4917694158594" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="109.44695066577279" y="802.5485381289993" width="556.4250885076563" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="109.44695066577279" y="823.9099578289993" width="162.65841971111695" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="109.44695066577279" y="845.2713775289992" width="6.408425909999999" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="109.44695066577279" y="866.6327972289992" width="653.0250640935938" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="109.44695066577279" y="887.9942169289991" width="630.375093085293" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="109.44695066577279" y="909.355636628999" width="605.3584152288477" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="109.44695066577279" y="930.717056328999" width="641.5584312505762" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="109.44695066577279" y="952.0784760289989" width="729.9917541570703" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="109.44695066577279" y="973.4398957289989" width="735.4084144659082" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="109.44695066577279" y="994.8013154289988" width="505.39176331234376" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="109.44695066577279" y="1016.1627351289987" width="6.408425909999999" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="109.44695066577279" y="1037.5241548289987" width="581.8917723722498" height="27.769845609999997"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="112.65116362077279" y="565.436779459" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Produce a 32-byte-long message called </text><text fill="blue" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="514.0011697242884" y="565.436779459" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">XOR_MASK</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="112.65116362077279" y="586.798199159" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">that the Server will decrypt with </text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="441.8178201149134" y="586.798199159" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RSA_public_decrypt()</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="680.3011575172571" y="586.798199159" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="112.65116362077279" y="608.1596188589999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">using the hardcoded public key.</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="112.65116362077279" y="629.5210385589999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"></text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="112.65116362077279" y="650.8824582589998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Two things are essential here:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="112.65116362077279" y="672.2438779589997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"></text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="112.65116362077279" y="693.6052976589997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(1) the fate of this message is to be decrypted with the</text><text fill="darkblue" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="112.65116362077279" y="714.9667173589996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">HARDCODED PUBLIC KEY</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="394.0011697242884" y="714.9667173589996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> and then </text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="496.2011666725306" y="714.9667173589996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">XOR</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="543.3011651466517" y="714.9667173589996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">ed with a </text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="112.65116362077279" y="736.3281370589996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">randomly generated secret text 31 ASCII-printable</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="112.65116362077279" y="757.6895567589995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bytes.</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="112.65116362077279" y="779.0509764589995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"></text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="112.65116362077279" y="800.4123961589994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(2) the result of these two operations will then be</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="112.65116362077279" y="821.7738158589993" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">concatenated with the salt </text><text fill="purple" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="386.48450712663214" y="821.7738158589993" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">using sprintf and the %s</text><text fill="purple" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="112.65116362077279" y="843.1352355589993" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">format string</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="262.55115751725714" y="843.1352355589993" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">.</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="112.65116362077279" y="864.4966552589992" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"></text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="112.65116362077279" y="885.8580749589992" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">If we can discover a phony ciphertext that, when decrypted with</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="112.65116362077279" y="907.2194946589991" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RSA_public_decrypy()</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="354.60116056901495" y="907.2194946589991" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">, with the </text><text fill="darkblue" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="455.2678246925501" y="907.2194946589991" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">HARDCODED PUBLIC KEY</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="112.65116362077279" y="928.580914358999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">and the </text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="195.81782774430795" y="928.580914358999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RSA_NO_PADDING</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="396.91783384782354" y="928.580914358999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> option, yields a bytestring that</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="112.65116362077279" y="949.942334058999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">begins with a byte between </text><text fill="darkgreen" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="396.601175827804" y="949.942334058999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">0x21</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.5845094154505" y="949.942334058999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> and </text><text fill="darkgreen" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="496.9178414772181" y="949.942334058999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">0x7f</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="541.2178407142786" y="949.942334058999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">, then we will have a</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="112.65116362077279" y="971.3037537589989" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1 in 92 chance of tricking the Server into generating a </text><text fill="blue" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="663.4011636207728" y="971.3037537589989" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">MASKED_SECRET</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="112.65116362077279" y="992.6651734589989" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">that begins with a </text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="299.7178292701868" y="992.6651734589989" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">NULL BYTE</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="421.10116056901495" y="992.6651734589989" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">. This will cause </text><text fill="blue" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="585.3678231666712" y="992.6651734589989" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">TEMP_KEY</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="687.5011544654993" y="992.6651734589989" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> and </text><text fill="blue" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="737.8344865272669" y="992.6651734589989" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">PERM_KEY</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="112.65116362077279" y="1014.0265931589988" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">to be nothing but hashes of their respective salts.</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="112.65116362077279" y="1035.3880128589988" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"></text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="112.65116362077279" y="1056.7494325589987" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Store the result of this search as </text><text fill="blue" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="444.2511697242884" y="1056.7494325589987" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">ENCRYPTED_XOR_MASK</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="681.78451017839" y="1056.7494325589987" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">.</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 73.48856083743945 1065.294000439 L 169.61494948743945 1065.294000439 L 169.61494948743945 1093.063846049 L 101.7568395737728 1093.063846049" stroke-miterlimit="10" stroke-width="1.7801183083333332" stroke-dasharray=""/><g transform="translate(84.16927068743945,1093.063846049) translate(-84.16927068743945,-1093.063846049)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 101.97045377077279 1084.1632545073332 L 84.16927068743945 1093.063846049 L 101.97045377077279 1101.9644375906666 Z"/></g></g><g><g><rect fill="white" stroke="none" x="290.0994368441256" y="1125.105975599" width="399.02509842586915" height="27.769845609999997"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="293.3036497991256" y="1144.331253329" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Send </text><text fill="blue" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="350.0369833867721" y="1144.331253329" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">ENCRYPTED_XOR_MASK</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="587.5703238408737" y="1144.331253329" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> to Server</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 84.16927068743945 1152.875821209 L 877.4671325403475 1152.875821209" stroke-miterlimit="10" stroke-width="1.7801183083333332" stroke-dasharray="8.544567879999999"/><g transform="translate(895.0547014266808,1152.875821209) translate(-895.0547014266808,-1152.875821209)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 877.2535183433475 1143.9752296673332 L 895.0547014266808 1152.875821209 L 877.2535183433475 1161.7764127506666 Z"/></g></g><g><g><rect fill="white" stroke="none" x="952.3745109550141" y="1184.917950759" width="623.2084404058496" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="952.3745109550141" y="1206.279370459" width="437.2417541570703" height="27.769845609999997"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="955.5787239100141" y="1204.143228489" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Decrypt </text><text fill="blue" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1041.228725435893" y="1204.143228489" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">ENCRYPTED_XOR_MASK</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1278.7620658899946" y="1204.143228489" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> with </text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1333.89540100352" y="1204.143228489" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RSA_public_decrypt()</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="955.5787239100141" y="1225.504648189" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">and store result as </text><text fill="blue" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1148.445392611186" y="1225.504648189" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">DECRYPTED_XOR_MASK</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 916.4161211266808 1234.049216069 L 1012.5425097766808 1234.049216069 L 1012.5425097766808 1261.819061679 L 944.6843998630142 1261.819061679" stroke-miterlimit="10" stroke-width="1.7801183083333332" stroke-dasharray=""/><g transform="translate(927.0968309766808,1261.819061679) translate(-927.0968309766808,-1261.819061679)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 944.8980140600141 1252.9184701373333 L 927.0968309766808 1261.819061679 L 944.8980140600141 1270.7196532206667 Z"/></g></g><g><g><rect fill="white" stroke="none" x="963.0552208050141" y="1293.861191229" width="425.9917694158594" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="963.0552208050141" y="1315.222610929" width="500.7584138937036" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="963.0552208050141" y="1336.584030629" width="435.14176331234376" height="27.769845609999997"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="966.2594337600141" y="1313.086468959" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Generate a string of 31 random, printable</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="966.2594337600141" y="1334.447888659" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">characters (between ASCII codes </text><text fill="darkgreen" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1302.9260902541546" y="1334.447888659" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">0x21</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1352.909423841801" y="1334.447888659" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> and </text><text fill="darkgreen" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1403.2427559035686" y="1334.447888659" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">0x7e</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1452.8094215529827" y="1334.447888659" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="966.2594337600141" y="1355.809308359" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">and store the result as </text><text fill="blue" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1198.3094368117718" y="1355.809308359" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">SECRET_PLAINTEXT</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 927.0968309766808 1364.353876239 L 1023.2232196266808 1364.353876239 L 1023.2232196266808 1392.123721849 L 955.3651097130141 1392.123721849" stroke-miterlimit="10" stroke-width="1.7801183083333332" stroke-dasharray=""/><g transform="translate(937.7775408266808,1392.123721849) translate(-937.7775408266808,-1392.123721849)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 955.5787239100141 1383.2231303073333 L 937.7775408266808 1392.123721849 L 955.5787239100141 1401.0243133906667 Z"/></g></g><g><g><rect fill="white" stroke="none" x="973.735930655014" y="1424.165851399" width="579.8917594976465" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="973.735930655014" y="1445.527271099" width="558.4917388982813" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="973.735930655014" y="1466.888690799" width="496.92508850765626" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="973.735930655014" y="1488.250110499" width="6.408425909999999" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="973.735930655014" y="1509.6115301989998" width="546.3250976629297" height="27.769845609999997"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="976.940143610014" y="1443.391129129" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Encrypt </text><text fill="blue" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1060.2068138370648" y="1443.391129129" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">SECRET_PLAINTEXT</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1256.8901481876508" y="1443.391129129" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> with </text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1312.0234833011762" y="1443.391129129" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RSA_public_encrypt()</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="976.940143610014" y="1464.752548829" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">using the hardcoded, 1024-bit public RSA key, with the</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="976.940143610014" y="1486.113968529" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RSA_NO_PADDING</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1178.0401497135297" y="1486.113968529" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> option set ("Textbook RSA").</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="976.940143610014" y="1507.475388229" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"></text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="976.940143610014" y="1528.8368079289999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Store the 128-byte result as </text><text fill="blue" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1263.690143610014" y="1528.8368079289999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">CHALLENGE_CIPHERTEXT</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 937.7775408266808 1537.381375809 L 1033.9039294766808 1537.381375809 L 1033.9039294766808 1565.151221419 L 966.0458195630141 1565.151221419" stroke-miterlimit="10" stroke-width="1.7801183083333332" stroke-dasharray=""/><g transform="translate(948.4582506766808,1565.151221419) translate(-948.4582506766808,-1565.151221419)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 966.2594337600141 1556.2506298773333 L 948.4582506766808 1565.151221419 L 966.2594337600141 1574.0518129606667 Z"/></g></g><g><g><rect fill="white" stroke="none" x="259.2775241008883" y="1597.193350969" width="503.39176331234376" height="27.769845609999997"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="262.4817370558883" y="1616.418628699" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Send 128-byte </text><text fill="blue" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="415.6150683547164" y="1616.418628699" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">CHALLENGE_CIPHERTEXT</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="668.7817401076461" y="1616.418628699" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> to Client</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 927.0968309766808 1624.963196579 L 112.4375494237728 1624.963196579" stroke-miterlimit="10" stroke-width="1.7801183083333332" stroke-dasharray="8.544567879999999"/><g transform="translate(94.84998053743945,1624.963196579) translate(-94.84998053743945,-1624.963196579)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 112.65116362077279 1616.0626050373332 L 94.84998053743945 1624.963196579 L 112.65116362077279 1633.8637881206666 Z"/></g></g><g><g><rect fill="white" stroke="none" x="973.735930655014" y="1657.005326129" width="483.17508993816773" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="973.735930655014" y="1678.366745829" width="503.9584117956201" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="973.735930655014" y="1699.7281655289999" width="185.5917540617029" height="27.769845609999997"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="976.940143610014" y="1676.230603859" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">XOR</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1024.0401420841351" y="1676.230603859" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> </text><text fill="blue" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1030.3901419887677" y="1676.230603859" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">SECRET_PLAINTEXT</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1227.0734763393536" y="1676.230603859" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> with the first 31 bytes</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="976.940143610014" y="1697.592023559" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">of </text><text fill="blue" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1002.5568104038373" y="1697.592023559" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">DECRYPTED_XOR_MASK</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1240.5234699497357" y="1697.592023559" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">, and store the result in</text><text fill="blue" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="976.940143610014" y="1718.9534432589999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">MASKED_SECRET</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1149.7734718570844" y="1718.9534432589999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">.</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 948.4582506766808 1727.498011139 L 1033.9039294766808 1727.498011139 L 1033.9039294766808 1755.267856749 L 966.0458195630141 1755.267856749" stroke-miterlimit="10" stroke-width="1.7801183083333332" stroke-dasharray=""/><g transform="translate(948.4582506766808,1755.267856749) translate(-948.4582506766808,-1755.267856749)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 966.2594337600141 1746.3672652073333 L 948.4582506766808 1755.267856749 L 966.2594337600141 1764.1684482906667 Z"/></g></g><g><g><rect fill="white" stroke="none" x="130.8083703657728" y="1787.309986299" width="450.4417511053125" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="130.8083703657728" y="1808.671405999" width="475.2084289617578" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="130.8083703657728" y="1830.0328256989999" width="375.8917571134607" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="130.8083703657728" y="1851.3942453989998" width="6.408425909999999" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="130.8083703657728" y="1872.7556650989998" width="457.04175720882813" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="130.8083703657728" y="1894.1170847989997" width="157.77508841228882" height="27.769845609999997"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="134.0125833207728" y="1806.535264029" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">We no longer need to be able to decrypt the</text><text fill="blue" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="134.0125833207728" y="1827.896683729" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">CHALLENGE_CIPHERTEXT</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="387.1792550737025" y="1827.896683729" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">, and so we no longer</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="134.0125833207728" y="1849.258103429" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">have any need of the </text><text fill="darkblue" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="353.6792550737025" y="1849.258103429" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">PRIVATE KEY</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="497.14591461960094" y="1849.258103429" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">.</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="134.0125833207728" y="1870.6195231289998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"></text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="134.0125833207728" y="1891.9809428289998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">We can simply set </text><text fill="blue" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="322.34591156784313" y="1891.9809428289998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">SECRET_PLAINTEXT</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="519.0292459184291" y="1891.9809428289998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> to the</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="134.0125833207728" y="1913.3423625289997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">empty string</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="279.02924591842907" y="1913.3423625289997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">.</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 94.84998053743945 1921.8869304090001 L 190.97636918743945 1921.8869304090001 L 190.97636918743945 1949.656776019 L 123.1182592737728 1949.656776019" stroke-miterlimit="10" stroke-width="1.7801183083333332" stroke-dasharray="8.544567879999999"/><g transform="translate(105.53069038743945,1949.656776019) translate(-105.53069038743945,-1949.656776019)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 123.33187347077279 1940.7561844773334 L 105.53069038743945 1949.656776019 L 123.33187347077279 1958.5573675606668 Z"/></g></g><g><g><rect fill="white" stroke="none" x="984.416640505014" y="1981.6989055690003" width="340.0250946111719" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="984.416640505014" y="2003.0603252690003" width="627.508409125332" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="984.416640505014" y="2024.4217449690002" width="586.8917456693689" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="984.416640505014" y="2045.7831646690001" width="137.67508850765626" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="984.416640505014" y="2067.1445843690003" width="6.408425909999999" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="984.416640505014" y="2088.5060040690005" width="589.0584198064844" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="984.416640505014" y="2109.8674237690007" width="620.708417517666" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="984.416640505014" y="2131.228843469001" width="509.0584150381128" height="27.769845609999997"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="987.620853460014" y="2000.9241832990003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Create two new strings by calling</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="987.620853460014" y="2022.2856029990003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">sprintf(</text><text fill="blue" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1072.1875191094282" y="2022.2856029990003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RAW_TEMP_KEY</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1229.7708473564985" y="2022.2856029990003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">, "</text><text fill="purple" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1251.6708469750288" y="2022.2856029990003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">%s</text><text fill="red" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1283.604179418266" y="2022.2856029990003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">+TEMP</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1354.5208435418012" y="2022.2856029990003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">", </text><text fill="blue" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1376.4208431603315" y="2022.2856029990003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">MASKED_SECRET</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1549.2541714074018" y="2022.2856029990003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1558.3875046135786" y="2022.2856029990003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">, and</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="987.620853460014" y="2043.6470226990002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">sprintf(</text><text fill="blue" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1072.1875191094282" y="2043.6470226990002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RAW_PERM_KEY</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1231.4541817070844" y="2043.6470226990002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">, "</text><text fill="purple" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1253.3541813256147" y="2043.6470226990002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">%s</text><text fill="red" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1285.287513768852" y="2043.6470226990002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">+PERM</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1357.8875122429731" y="2043.6470226990002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">", </text><text fill="blue" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1379.7875118615034" y="2043.6470226990002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">MASKED_SECRET</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1552.6208401085737" y="2043.6470226990002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1561.7541733147505" y="2043.6470226990002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="987.620853460014" y="2065.008442399" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">respectively. </text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="987.620853460014" y="2086.3698620990003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"></text><text fill="red" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="987.620853460014" y="2107.7312817990005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Note that if </text><text fill="blue" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1124.5375252129438" y="2107.7312817990005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">MASKED_SECRET</text><text fill="red" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1297.3708534600141" y="2107.7312817990005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> begins with a null byte,</text><text fill="red" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="987.620853460014" y="2129.0927014990007" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">then the strings </text><text fill="blue" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1176.1208534600141" y="2129.0927014990007" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RAW_TEMP_KEY</text><text fill="red" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1333.7041817070844" y="2129.0927014990007" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> and  </text><text fill="blue" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1396.654182470024" y="2129.0927014990007" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RAW_PERM_KEY</text><text fill="red" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1555.9208450676801" y="2129.0927014990007" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> will</text><text fill="red" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="987.620853460014" y="2150.454121199001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">just be </text><text fill="darkred" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1071.987522161186" y="2150.454121199001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">"+TEMP"</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1171.4375191094282" y="2150.454121199001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> </text><text fill="red" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1178.404185807884" y="2150.454121199001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">and</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1220.4541850449446" y="2150.454121199001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> </text><text fill="darkred" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1227.4208517434004" y="2150.454121199001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">"+PERM"</text><text fill="red" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1328.6208486916425" y="2150.454121199001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">, respectively!</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 948.4582506766808 2158.998689079 L 1044.5846393266806 2158.998689079 L 1044.5846393266806 2186.7685346890003 L 976.7265294130141 2186.7685346890003" stroke-miterlimit="10" stroke-width="1.7801183083333332" stroke-dasharray=""/><g transform="translate(959.1389605266808,2186.7685346890003) translate(-959.1389605266808,-2186.7685346890003)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 976.940143610014 2177.867943147334 L 959.1389605266808 2186.7685346890003 L 976.940143610014 2195.6691262306667 Z"/></g></g><g><g><rect fill="white" stroke="none" x="984.416640505014" y="2218.8106642390003" width="669.8250824041406" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="984.416640505014" y="2240.1720839390005" width="595.1917487211267" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="984.416640505014" y="2261.5335036390006" width="131.32509003353516" height="27.769845609999997"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="987.620853460014" y="2238.0359419690003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Compute the </text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1124.3708534600141" y="2238.0359419690003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">MD5</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1174.7875213982466" y="2238.0359419690003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> hashes of </text><text fill="blue" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1283.8541870476606" y="2238.0359419690003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RAW_TEMP_KEY</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1441.437515294731" y="2238.0359419690003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> and </text><text fill="blue" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1491.7708473564985" y="2238.0359419690003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RAW_PERM_KEY</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="987.620853460014" y="2259.3973616690005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">and store the 16-byte results as </text><text fill="blue" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1313.7708473564985" y="2259.3973616690005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">TEMP_KEY</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1415.9041786553266" y="2259.3973616690005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> and </text><text fill="blue" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1466.2375107170942" y="2259.3973616690005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">PERM_KEY</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1570.0541763665083" y="2259.3973616690005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="987.620853460014" y="2280.7587813690006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">respectively.</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 959.1389605266808 2289.303349249 L 1044.5846393266806 2289.303349249 L 1044.5846393266806 2317.073194859 L 976.7265294130141 2317.073194859" stroke-miterlimit="10" stroke-width="1.7801183083333332" stroke-dasharray=""/><g transform="translate(959.1389605266808,2317.073194859) translate(-959.1389605266808,-2317.073194859)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 976.940143610014 2308.1726033173336 L 959.1389605266808 2317.073194859 L 976.940143610014 2325.9737864006665 Z"/></g></g><g><g><rect fill="white" stroke="none" x="141.4890802157728" y="2349.115324409" width="496.85843811703126" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="141.4890802157728" y="2370.4767441090003" width="318.9750948972742" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="141.4890802157728" y="2391.8381638090004" width="6.408425909999999" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="141.4890802157728" y="2413.1995835090006" width="488.59174881649415" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="141.4890802157728" y="2434.561003209001" width="370.7084327764551" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="141.4890802157728" y="2455.922422909001" width="489.37509117794434" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="141.4890802157728" y="2477.283842609001" width="529.9750991888086" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="141.4890802157728" y="2498.6452623090013" width="527.6250778265039" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="141.4890802157728" y="2520.0066820090015" width="138.64176331234376" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="141.4890802157728" y="2541.3681017090016" width="6.408425909999999" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="141.4890802157728" y="2562.729521409002" width="558.4251075811426" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="141.4890802157728" y="2584.090941109002" width="540.40842591" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="141.4890802157728" y="2605.452360809002" width="72.47509155941407" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="141.4890802157728" y="2626.8137805090023" width="6.408425909999999" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="141.4890802157728" y="2648.1752002090025" width="292.0917616910974" height="27.769845609999997"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="144.6932931707728" y="2368.340602139" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">The Client is now expected to append one of two</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="144.6932931707728" y="2389.7020218390003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">suffixes to </text><text fill="blue" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="253.8432946966517" y="2389.7020218390003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">xor(XOR_MASK,SECRET_PLAINTEXT)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="450.52662904723763" y="2389.7020218390003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="144.6932931707728" y="2411.0634415390005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"></text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="144.6932931707728" y="2432.4248612390006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">- "</text><text fill="red" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="167.4599595831263" y="2432.4248612390006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">+TEMP</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="238.37662370666146" y="2432.4248612390006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">", to launch a </text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="378.5099550054896" y="2432.4248612390006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">telnetd</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="460.17661912902474" y="2432.4248612390006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> session that will</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="144.6932931707728" y="2453.786280939001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">   last until the router is rebooted, </text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="italic" font-weight="normal" text-decoration="normal" x="488.5432992742884" y="2453.786280939001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">or</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="144.6932931707728" y="2475.147700639001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">-  "</text><text fill="red" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="173.80995996459603" y="2475.147700639001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">+PERM</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="246.40995843871713" y="2475.147700639001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">", to write a flag to a physical volume,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="144.6932931707728" y="2496.509120339001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">   which the </text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="267.5432916448939" y="2496.509120339001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">telnetd_startup</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="442.15996034606576" y="2496.509120339001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> daemon will check for</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="144.6932931707728" y="2517.8705400390013" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">   when the system is rebooted, and launch </text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="584.2432809637415" y="2517.8705400390013" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">telnetd</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="144.6932931707728" y="2539.2319597390015" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">   if it finds it.</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="144.6932931707728" y="2560.5933794390016" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"></text><text fill="red" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="144.6932931707728" y="2581.954799139002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Remember that we have effectively set </text><text fill="blue" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="469.7599740789759" y="2581.954799139002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">xor(XOR_MASK,SECRET_PLAINTEXT)</text><text fill="red" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="666.4433084295619" y="2581.954799139002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> to</text><text fill="red" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="144.6932931707728" y="2603.316218839002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">the empty string, so the suffix is all we need to</text><text fill="red" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="144.6932931707728" y="2624.677638539002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">know.</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="144.6932931707728" y="2646.0390582390023" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"></text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="144.6932931707728" y="2667.4004779390025" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Store the result in </text><text fill="blue" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="330.6099649237025" y="2667.4004779390025" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RAW_KEY</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="424.02662904723763" y="2667.4004779390025" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">.</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 105.53069038743945 2675.945045819 L 201.65707903743944 2675.945045819 L 201.65707903743944 2703.714891429 L 133.7989691237728 2703.714891429" stroke-miterlimit="10" stroke-width="1.7801183083333332" stroke-dasharray="8.544567879999999"/><g transform="translate(116.21140023743945,2703.714891429) translate(-116.21140023743945,-2703.714891429)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 134.0125833207728 2694.8142998873336 L 116.21140023743945 2703.714891429 L 134.0125833207728 2712.6154829706666 Z"/></g></g><g><g><rect fill="white" stroke="none" x="152.1697900657728" y="2735.757020979" width="480.60842667293946" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="152.1697900657728" y="2757.1184406790003" width="302.35841665935914" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="152.1697900657728" y="2778.4798603790005" width="6.408425909999999" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="152.1697900657728" y="2799.8412800790006" width="501.35843811703126" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="152.1697900657728" y="2821.202699779001" width="293.15842591" height="27.769845609999997"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="155.3740030207728" y="2754.982298709" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Compute the </text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="292.12400302077276" y="2754.982298709" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">MD5</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="342.5406709590052" y="2754.982298709" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> hash of </text><text fill="blue" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="428.8906694331263" y="2754.982298709" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RAW_KEY</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="522.3073335566614" y="2754.982298709" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">, and store</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="155.3740030207728" y="2776.3437184090003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">the result in </text><text fill="blue" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="282.07399996901495" y="2776.3437184090003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">BACKDOOR_KEY</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="444.9739938654993" y="2776.3437184090003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">.</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="155.3740030207728" y="2797.7051381090005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"></text><text fill="red" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="155.3740030207728" y="2819.0665578090006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Here, all we need to do is compute the MD5</text><text fill="red" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="155.3740030207728" y="2840.427977509001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">hash of </text><text fill="darkred" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="245.607332793722" y="2840.427977509001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">+TEMP</text><text fill="red" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="324.22400149489386" y="2840.427977509001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> or </text><text fill="darkred" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="361.7573343196009" y="2840.427977509001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">+PERM</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 116.21140023743945 2848.972545389 L 212.33778888743944 2848.972545389 L 212.33778888743944 2876.7423909990002 L 144.4796789737728 2876.7423909990002" stroke-miterlimit="10" stroke-width="1.7801183083333332" stroke-dasharray="8.544567879999999"/><g transform="translate(126.89211008743945,2876.7423909990002) translate(-126.89211008743945,-2876.7423909990002)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 144.6932931707728 2867.8417994573338 L 126.89211008743945 2876.7423909990002 L 144.6932931707728 2885.6429825406667 Z"/></g></g><g><g><rect fill="white" stroke="none" x="375.47930444793406" y="2908.7845205490003" width="324.39175186825196" height="27.769845609999997"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="378.68351740293406" y="2928.0097982790003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Send </text><text fill="blue" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="435.41685099058054" y="2928.0097982790003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">BACKDOOR_KEY</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="598.3168448870649" y="2928.0097982790003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> to Server</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 126.89211008743945 2936.5543661590004 L 930.8706817903475 2936.5543661590004" stroke-miterlimit="10" stroke-width="1.7801183083333332" stroke-dasharray="8.544567879999999"/><g transform="translate(948.4582506766808,2936.5543661590004) translate(-948.4582506766808,-2936.5543661590004)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 930.6570675933475 2927.653774617334 L 948.4582506766808 2936.5543661590004 L 930.6570675933475 2945.454957700667 Z"/></g></g><g><g><rect fill="white" stroke="none" x="995.097350355014" y="2968.5964957090005" width="444.4750834531824" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="995.097350355014" y="2989.9579154090006" width="423.8250838346521" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="995.097350355014" y="3011.319335109001" width="409.64176331234376" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="995.097350355014" y="3032.680754809001" width="394.2250877447168" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="995.097350355014" y="3054.042174509001" width="183.6084228582422" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="995.097350355014" y="3075.4035942090013" width="6.408425909999999" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="995.097350355014" y="3096.7650139090015" width="446.1584178037683" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="995.097350355014" y="3118.1264336090017" width="442.9917555875818" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="995.097350355014" y="3139.487853309002" width="436.6250868864099" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="995.097350355014" y="3160.849273009002" width="464.625093085293" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="995.097350355014" y="3182.210692709002" width="484.7417541570703" height="27.769845609999997"/></g><g><rect fill="white" stroke="none" x="995.097350355014" y="3203.5721124090023" width="445.4917465276758" height="27.769845609999997"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="998.301563310014" y="2987.8217734390005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">If</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1014.4348965161907" y="2987.8217734390005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> </text><text fill="blue" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1020.7848964208233" y="2987.8217734390005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">BACKDOOR_KEY</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1183.6848903173077" y="2987.8217734390005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> matches </text><text fill="blue" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1282.3682246678936" y="2987.8217734390005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">TEMP_KEY</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1384.5015559667218" y="2987.8217734390005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> then</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="998.301563310014" y="3009.1831931390007" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">call </text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1039.0015640729534" y="3009.1831931390007" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">system("</text><text fill="red" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1139.3515625470745" y="3009.1831931390007" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">telnetd -l /bin/login.sh</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1389.818222092973" y="3009.1831931390007" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">")</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1409.3682213300335" y="3009.1831931390007" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="998.301563310014" y="3030.544612839001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">launching an unencrypted </text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1267.0182381147015" y="3030.544612839001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">telnetd</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1348.6849022382366" y="3030.544612839001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> shell</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="998.301563310014" y="3051.906032539001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">as </text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1027.3182297223675" y="3051.906032539001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">root</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1074.2182312482464" y="3051.906032539001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">. No credentials are required to</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="998.301563310014" y="3073.267452239001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">log into this shell.</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="998.301563310014" y="3094.6288719390013" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"></text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="998.301563310014" y="3115.9902916390015" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">If</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1014.4348965161907" y="3115.9902916390015" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> </text><text fill="blue" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1020.7848964208233" y="3115.9902916390015" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">BACKDOOR_KEY</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1183.6848903173077" y="3115.9902916390015" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> matches </text><text fill="blue" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1282.3682246678936" y="3115.9902916390015" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">PERM_KEY</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1386.1848903173077" y="3115.9902916390015" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> then</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="998.301563310014" y="3137.3517113390017" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">call </text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1039.0015640729534" y="3137.3517113390017" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">system("</text><text fill="red" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1139.3515625470745" y="3137.3517113390017" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">iwpriv ra0 e2p 26=7010</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1408.9848938459027" y="3137.3517113390017" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">")</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1428.5348930829632" y="3137.3517113390017" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="998.301563310014" y="3158.713131039002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">writing the bytes [HEX: </text><text fill="darkgreen" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1236.4348946088421" y="3158.713131039002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">7010</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1287.3015594953167" y="3158.713131039002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">] to </text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1327.8848915570843" y="3158.713131039002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">EEPROM</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1422.1682243817913" y="3158.713131039002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="998.301563310014" y="3180.074550739002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">at offset </text><text fill="darkgreen" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1087.6848946088421" y="3180.074550739002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">0x26</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1137.6682281964886" y="3180.074550739002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> (virtual address </text><text fill="darkgreen" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1307.0182343000042" y="3180.074550739002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">0x40026</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1395.1515655988323" y="3180.074550739002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">). This</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="998.301563310014" y="3201.435970439002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">code will instruct the </text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1214.0182228559124" y="3201.435970439002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">telnetd_startup</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1388.6348915570843" y="3201.435970439002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> daemon</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="998.301563310014" y="3222.7973901390023" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">to launch </text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1097.9348946088421" y="3222.7973901390023" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">telnetd -l /bin/login.sh</text><text fill="black" stroke="none" font-family="sans-serif" font-size="15pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1348.4015541547406" y="3222.7973901390023" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> on boot.</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 969.8196703766807 3231.3419580190002 L 1055.2653491766807 3231.3419580190002 L 1055.2653491766807 3259.1118036290004 L 987.407239263014 3259.1118036290004" stroke-miterlimit="10" stroke-width="1.7801183083333332" stroke-dasharray="8.544567879999999"/><g transform="translate(969.8196703766807,3259.1118036290004) translate(-969.8196703766807,-3259.1118036290004)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 987.620853460014 3250.211212087334 L 969.8196703766807 3259.1118036290004 L 987.620853460014 3268.012395170667 Z"/></g></g></g><g/><g/></g></svg>
